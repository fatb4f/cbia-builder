{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.local/cbia/inf1250/drill-block.schema.json",
  "title": "INF1250 Drill Block",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "id",
    "module",
    "tp",
    "drill_type",
    "prompt",
    "expected_action",
    "evaluation_rule",
    "items",
    "meta"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Stable identifier. Suggested: inf1250-m2-da, inf1250-m2-db, etc.",
      "pattern": "^inf1250-m\\d+-d[a-d]$"
    },
    "module": {
      "type": "string",
      "enum": [
        "M1",
        "M2",
        "M3",
        "M4",
        "M5"
      ]
    },
    "tp": {
      "type": "string",
      "enum": [
        "TP1",
        "TP2",
        "TP3"
      ]
    },
    "drill_type": {
      "type": "string",
      "enum": [
        "A",
        "B",
        "C",
        "D"
      ],
      "description": "A Identification, B Classification, C Boundary marking, D Complexity intuition."
    },
    "prompt": {
      "type": "string",
      "minLength": 10,
      "maxLength": 600
    },
    "expected_action": {
      "type": "string",
      "minLength": 10,
      "maxLength": 300,
      "description": "What the learner must produce (e.g., 'label control primitive + abstraction')."
    },
    "evaluation_rule": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Binary/terse rubric for self-check."
    },
    "items": {
      "type": "array",
      "minItems": 4,
      "maxItems": 20,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "id",
          "stem"
        ],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^i\\d+$"
          },
          "stem": {
            "type": "string",
            "minLength": 5,
            "maxLength": 500
          },
          "answer_key": {
            "type": "string",
            "maxLength": 300,
            "description": "Optional short key."
          },
          "notes": {
            "type": "string",
            "maxLength": 300
          }
        }
      }
    },
    "meta": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "version",
        "created",
        "last_updated",
        "source",
        "notes"
      ],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "created": {
          "type": "string",
          "format": "date"
        },
        "last_updated": {
          "type": "string",
          "format": "date"
        },
        "source": {
          "type": "string"
        },
        "notes": {
          "type": "string",
          "maxLength": 800
        }
      }
    }
  }
}